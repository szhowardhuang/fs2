#include <ansi.h>
inherit F_SPELL;
inherit SSERVER;
int fun;
int conjure (object me,object target)
{
fun=me->query("spells/mirror/level");
	if (!me->query("spells/mirror/level"))
     		return 0;
	if(me->query("class")!="dancer")
		return notify_fail("这法术只有舞者能用。\n");
	if( !target ) target = offensive_target(me);
	if(me->query_temp("mirror")==1)
		return notify_fail("的神灵尚未归位!!\n");
		message_vision(HIW"$N三魂之一的神灵飞入了$n的体内!!\n"NOR,me,target);
		tell_object(me,HIM"         ※※※※※※"HIW+target->query("name")+HIM"※※※※※※"NOR"
        
                "HIW"经验："+target->query("combat_exp")+"\n"NOR);
	if(fun>20)
		tell_object(me,HIW"\n                精力："+target->query("gin")+NOR"

                "HIW"气血："+target->query("kee")+NOR"

                "HIW"神瞑："+target->query("sen")+NOR"

                "HIW"内力："+target->query("force")+"\n"NOR);
	if(fun>60)
		tell_object(me,HIW"\n                运行功\力："+target->query("force_factor")+"\n"NOR);
		me->set_temp("mirror",1);
		call_out("message",3,me);
        return 1;
}

int message()
{
object me=this_player();
	message_vision(HIW"$N的神灵回归本位了。\n"NOR,me);
	if(fun<100) spell_improved("mirror",random(500));
		me->delete_temp("mirror");
return 1;
}
